<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Noble">
<meta name="dcterms.date" content="2023-02-24">

<title>orchaRd 2.0 Tutorial: ESMARConf2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="Noble_ESMARConf_2023_Orchard2.0_files/libs/clipboard/clipboard.min.js"></script>
<script src="Noble_ESMARConf_2023_Orchard2.0_files/libs/quarto-html/quarto.js"></script>
<script src="Noble_ESMARConf_2023_Orchard2.0_files/libs/quarto-html/popper.min.js"></script>
<script src="Noble_ESMARConf_2023_Orchard2.0_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Noble_ESMARConf_2023_Orchard2.0_files/libs/quarto-html/anchor.min.js"></script>
<link href="Noble_ESMARConf_2023_Orchard2.0_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Noble_ESMARConf_2023_Orchard2.0_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Noble_ESMARConf_2023_Orchard2.0_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Noble_ESMARConf_2023_Orchard2.0_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Noble_ESMARConf_2023_Orchard2.0_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title"><strong>Table of Contents</strong></h2>
   
  <ul>
  <li><a href="#how-to-download-and-install-orchard-vers.-2.0" id="toc-how-to-download-and-install-orchard-vers.-2.0" class="nav-link active" data-scroll-target="#how-to-download-and-install-orchard-vers.-2.0"><span class="toc-section-number">1</span>  How to Download and Install Orchard (vers. 2.0)</a></li>
  <li><a href="#orchard-and-bubble-plots" id="toc-orchard-and-bubble-plots" class="nav-link" data-scroll-target="#orchard-and-bubble-plots"><span class="toc-section-number">2</span>  Orchard and Bubble Plots</a>
  <ul class="collapse">
  <li><a href="#lets-load-a-dataset" id="toc-lets-load-a-dataset" class="nav-link" data-scroll-target="#lets-load-a-dataset"><span class="toc-section-number">2.1</span>  Lets load a dataset</a></li>
  <li><a href="#orchard-plots" id="toc-orchard-plots" class="nav-link" data-scroll-target="#orchard-plots"><span class="toc-section-number">2.2</span>  Orchard Plots</a></li>
  <li><a href="#subsetting-levels-in-orchard-plots" id="toc-subsetting-levels-in-orchard-plots" class="nav-link" data-scroll-target="#subsetting-levels-in-orchard-plots"><span class="toc-section-number">2.3</span>  Subsetting levels in orchard plots</a></li>
  <li><a href="#bubble-plots" id="toc-bubble-plots" class="nav-link" data-scroll-target="#bubble-plots"><span class="toc-section-number">2.4</span>  Bubble plots</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><strong>orchaRd 2.0</strong> Tutorial: ESMARConf2023</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Noble </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="how-to-download-and-install-orchard-vers.-2.0" class="level1 page-columns page-full" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> How to Download and Install Orchard (vers. 2.0)</h1>
<p>Orchard 2.0 is not yet on <strong>CRAN</strong>. You can download the package by visiting our <a href="https://github.com/daniel1noble/orchaRd">GitHub</a> page.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you don’t already have the <code>pacman</code> package <strong>remember to unannotate code line 3</strong></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r code-overflow-scroll number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"daniel1noble/orchaRd"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># install.packages("pacman")</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(devtools, tidyverse, metafor, patchwork, </span>
<span id="cb1-5"><a href="#cb1-5"></a>        R.rsp, orchaRd, emmeans, ape, phytools, gt, flextable)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scipen =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Techncially we don’t need all these packages to download <code>orchaRd</code>, but we’ll use them throughout the examples. <code>orchaRd</code> does rely heavly on the <code>emmeans</code> and <code>tidyverse</code> packages. You will need to ensure that you have R updated to the required version for <code>emmeans</code> to work as it has version requirements.</p>
</div></div><p>We also have a <a href="https://daniel1noble.github.io/orchaRd/">detailed vignette</a> which will show much of it’s functionality.</p>
</section>
<section id="orchard-and-bubble-plots" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Orchard and Bubble Plots</h1>
<section id="lets-load-a-dataset" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="lets-load-a-dataset"><span class="header-section-number">2.1</span> Lets load a dataset</h2>
<p>We’ll use a very simple meta-analysis dataset that is attached to <code>orchaRd</code> to demonstrate how you can make orchard plots and bubble plots from meta-regression models. The data come from <span class="citation" data-cites="Lim2014">Lim, Senior, and Nakagawa (<a href="#ref-Lim2014" role="doc-biblioref">2014</a>)</span>. This is a meta-analysis comparing correlation coefficients (rather Fisher’s <em>Z</em> Transformed Correlation), and is useful as it demonstrates a number of orchard plot functions</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r code-overflow-scroll number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load the lim dataset</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">data</span>(lim)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Add in the sampling variance</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>lim<span class="sc">$</span>vi <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(lim<span class="sc">$</span>N <span class="sc">-</span> <span class="dv">3</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Lets fit a meta-regression </span></span>
<span id="cb2-8"><a href="#cb2-8"></a>lim_MR <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> yi, <span class="at">V =</span> vi, </span>
<span id="cb2-9"><a href="#cb2-9"></a>                    <span class="at">mods =</span> <span class="sc">~</span>Phylum <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb2-10"><a href="#cb2-10"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Article, </span>
<span id="cb2-11"><a href="#cb2-11"></a>                                 <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Datapoint), </span>
<span id="cb2-12"><a href="#cb2-12"></a>                    <span class="at">data =</span> lim)</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="fu">summary</span>(lim_MR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 357; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-97.6524  195.3049  213.3049  248.0263  213.8343   

Variance Components:

            estim    sqrt  nlvls  fixed     factor 
sigma^2.1  0.0411  0.2029    220     no    Article 
sigma^2.2  0.0309  0.1757    357     no  Datapoint 

Test for Residual Heterogeneity:
QE(df = 350) = 1912.9637, p-val &lt; .0001

Test of Moderators (coefficients 1:7):
QM(df = 7) = 356.6775, p-val &lt; .0001

Model Results:

                       estimate      se     zval    pval    ci.lb   ci.ub      
PhylumArthropoda         0.2690  0.0509   5.2829  &lt;.0001   0.1692  0.3687  *** 
PhylumChordata           0.3908  0.0224  17.4190  &lt;.0001   0.3468  0.4347  *** 
PhylumEchinodermata      0.8582  0.3902   2.1992  0.0279   0.0934  1.6230    * 
PhylumMollusca           0.4867  0.1275   3.8175  0.0001   0.2368  0.7366  *** 
PhylumNematoda           0.4477  0.3054   1.4658  0.1427  -0.1509  1.0463      
PhylumPlatyhelminthes    0.4935  0.2745   1.7980  0.0722  -0.0444  1.0314    . 
PhylumRotifera           0.4722  0.3021   1.5634  0.1180  -0.1198  1.0642      

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Here, we have fit a multi-level meta-regression model, with two random effects (Article / Study) and a within study variance. You will notice that we have a Phylum moderator as we are intersted in estimating the meta-analytic mean within each major phyla (<a href="#fig-orchard1">Figure&nbsp;1</a>).</p>
</section>
<section id="orchard-plots" class="level2 page-columns page-full" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="orchard-plots"><span class="header-section-number">2.2</span> Orchard Plots</h2>
<p>Using this model and data lets demonstrate how to make orchard plots. This can be done with the <code>orchard_plot</code> function.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>If you’re not sure what arguments <code>orchard_plot</code> takes you can explore the vigette or ask for help using <code>?orchard_plot</code></p>
</div><div class="">
<p><code>orchard_plot</code> takes a few essential arguments:</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-args" class="anchored">

<div id="wiqxqcitnf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#wiqxqcitnf) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#wiqxqcitnf) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#wiqxqcitnf) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#wiqxqcitnf) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#wiqxqcitnf) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#wiqxqcitnf) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#wiqxqcitnf) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#wiqxqcitnf) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#wiqxqcitnf) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#wiqxqcitnf) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#wiqxqcitnf) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#wiqxqcitnf) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#wiqxqcitnf) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#wiqxqcitnf) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wiqxqcitnf) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#wiqxqcitnf) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#wiqxqcitnf) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wiqxqcitnf) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#wiqxqcitnf) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wiqxqcitnf) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#wiqxqcitnf) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wiqxqcitnf) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#wiqxqcitnf) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wiqxqcitnf) .gt_left {
  text-align: left;
}

:where(#wiqxqcitnf) .gt_center {
  text-align: center;
}

:where(#wiqxqcitnf) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#wiqxqcitnf) .gt_font_normal {
  font-weight: normal;
}

:where(#wiqxqcitnf) .gt_font_bold {
  font-weight: bold;
}

:where(#wiqxqcitnf) .gt_font_italic {
  font-style: italic;
}

:where(#wiqxqcitnf) .gt_super {
  font-size: 65%;
}

:where(#wiqxqcitnf) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#wiqxqcitnf) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#wiqxqcitnf) .gt_indent_1 {
  text-indent: 5px;
}

:where(#wiqxqcitnf) .gt_indent_2 {
  text-indent: 10px;
}

:where(#wiqxqcitnf) .gt_indent_3 {
  text-indent: 15px;
}

:where(#wiqxqcitnf) .gt_indent_4 {
  text-indent: 20px;
}

:where(#wiqxqcitnf) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table"><caption>Table&nbsp;1:  Key arguments </caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Argument">Argument</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Description">Description</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Argument" class="gt_row gt_left">model</td>
<td headers="Description" class="gt_row gt_left">The metafor model object (e.g., rma.mv)</td></tr>
    <tr><td headers="Argument" class="gt_row gt_left">mod</td>
<td headers="Description" class="gt_row gt_left">The moderator of interest (as a character). If you don't specify it will default to the overall meta-analytic mean</td></tr>
    <tr><td headers="Argument" class="gt_row gt_left">data</td>
<td headers="Description" class="gt_row gt_left">The dataset used to fit the model</td></tr>
    <tr><td headers="Argument" class="gt_row gt_left">group</td>
<td headers="Description" class="gt_row gt_left">The group you wish to tally N for within brackets</td></tr>
    <tr><td headers="Argument" class="gt_row gt_left">xlab</td>
<td headers="Description" class="gt_row gt_left">The axis label for the effect size</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</div></div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>orchaRd<span class="sc">::</span><span class="fu">orchard_plot</span>(lim_MR, <span class="at">mod =</span> <span class="st">"Phylum"</span>, <span class="at">group =</span> <span class="st">"Article"</span>, <span class="at">data =</span> lim, <span class="at">xlab =</span> <span class="st">"Correlation coefficient"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">transfm =</span> <span class="st">"tanh"</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">N =</span> <span class="st">"N"</span>, <span class="at">cb =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-orchard1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Noble_ESMARConf_2023_Orchard2.0_files/figure-html/fig-orchard1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Orchard plot of the <span class="citation" data-cites="Lim2014">Lim, Senior, and Nakagawa (<a href="#ref-Lim2014" role="doc-biblioref">2014</a>)</span> meta-regression model. Plotted are meta-anlaytic means, 95% confidence intervals, 95% prediction intervals and the raw effect size data weighted by the the sample size. In this case, <em>k</em> is the number of effect sizes and the number of studies are provided within brackets.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="subsetting-levels-in-orchard-plots" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="subsetting-levels-in-orchard-plots"><span class="header-section-number">2.3</span> Subsetting levels in orchard plots</h2>
<p><a href="#fig-orchard1">Figure&nbsp;1</a> looks pretty bad. There’s very little data in most phyla. So, lets change this by restricting the plotting to only taxa with sufficient data. We can do this using the <code>at</code> argument to limit the prediction to only three phylo.</p>
<p>Here we’ll demonstrate a two step approach which can also provide a table of the meta-analytic means which can be used in publications</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use mod_results to first create a table. It takes the same arguments as orchard_plot()</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    lim_MR_results <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">mod_results</span>(lim_MR, <span class="at">mod =</span> <span class="st">"Phylum"</span>, <span class="at">group =</span> <span class="st">"Article"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> lim, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">Phylum =</span> <span class="fu">c</span>(<span class="st">"Chordata"</span>, <span class="st">"Arthropoda"</span>, <span class="st">"Mollusca"</span>)), <span class="at">subset =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we can feed in the mod_results() table directly to orchaRd</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    orchaRd<span class="sc">::</span><span class="fu">orchard_plot</span>(lim_MR_results, <span class="at">data =</span> lim, <span class="at">xlab =</span> <span class="st">"Correlation coefficient"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">transfm =</span> <span class="st">"tanh"</span>, <span class="at">g =</span> <span class="cn">TRUE</span>, <span class="at">angle =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lim_sub" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Noble_ESMARConf_2023_Orchard2.0_files/figure-html/fig-lim_sub-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Orchard plot that subsets the levels</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Ok, this is more useful, but lets also make a nice table with the <code>mod_results</code> to report in our meta-analysis, which we can see in <a href="#tbl-lim">Table&nbsp;2</a>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(lim_MR_results<span class="sc">$</span>mod_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-lim" class="anchored">

<div id="fzbhymofik" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#fzbhymofik) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#fzbhymofik) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#fzbhymofik) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#fzbhymofik) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#fzbhymofik) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#fzbhymofik) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#fzbhymofik) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#fzbhymofik) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#fzbhymofik) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#fzbhymofik) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#fzbhymofik) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#fzbhymofik) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#fzbhymofik) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#fzbhymofik) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fzbhymofik) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#fzbhymofik) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#fzbhymofik) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fzbhymofik) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#fzbhymofik) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fzbhymofik) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#fzbhymofik) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fzbhymofik) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#fzbhymofik) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fzbhymofik) .gt_left {
  text-align: left;
}

:where(#fzbhymofik) .gt_center {
  text-align: center;
}

:where(#fzbhymofik) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#fzbhymofik) .gt_font_normal {
  font-weight: normal;
}

:where(#fzbhymofik) .gt_font_bold {
  font-weight: bold;
}

:where(#fzbhymofik) .gt_font_italic {
  font-style: italic;
}

:where(#fzbhymofik) .gt_super {
  font-size: 65%;
}

:where(#fzbhymofik) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#fzbhymofik) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#fzbhymofik) .gt_indent_1 {
  text-indent: 5px;
}

:where(#fzbhymofik) .gt_indent_2 {
  text-indent: 10px;
}

:where(#fzbhymofik) .gt_indent_3 {
  text-indent: 15px;
}

:where(#fzbhymofik) .gt_indent_4 {
  text-indent: 20px;
}

:where(#fzbhymofik) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table"><caption>Table&nbsp;2:  Meta-analytic mean, 95% CIs, 95% PI’s for the three phyla. To do this we need to extract the mod_table from the orchaRd object. </caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="name">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowerCL">lowerCL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="upperCL">upperCL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowerPR">lowerPR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="upperPR">upperPR</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="name" class="gt_row gt_center">Chordata</td>
<td headers="estimate" class="gt_row gt_right">0.391</td>
<td headers="lowerCL" class="gt_row gt_right">0.347</td>
<td headers="upperCL" class="gt_row gt_right">0.435</td>
<td headers="lowerPR" class="gt_row gt_right">-0.1370</td>
<td headers="upperPR" class="gt_row gt_right">0.919</td></tr>
    <tr><td headers="name" class="gt_row gt_center">Arthropoda</td>
<td headers="estimate" class="gt_row gt_right">0.269</td>
<td headers="lowerCL" class="gt_row gt_right">0.169</td>
<td headers="upperCL" class="gt_row gt_right">0.369</td>
<td headers="lowerPR" class="gt_row gt_right">-0.2664</td>
<td headers="upperPR" class="gt_row gt_right">0.804</td></tr>
    <tr><td headers="name" class="gt_row gt_center">Mollusca</td>
<td headers="estimate" class="gt_row gt_right">0.487</td>
<td headers="lowerCL" class="gt_row gt_right">0.237</td>
<td headers="upperCL" class="gt_row gt_right">0.737</td>
<td headers="lowerPR" class="gt_row gt_right">-0.0956</td>
<td headers="upperPR" class="gt_row gt_right">1.069</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="bubble-plots" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="bubble-plots"><span class="header-section-number">2.4</span> Bubble plots</h2>
<p>We often have moderators that are continuous in meta-analyis, particularly when considering things like publication bias. Here, <code>bubble_plots</code> can be extremely useful (<a href="#fig-bubble">Figure&nbsp;3</a>).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll add publication year in to the data and calculate the sampling variance</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    lim[, <span class="st">"year"</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lim<span class="sc">$</span>year)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    lim<span class="sc">$</span>vi <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(lim<span class="sc">$</span>N <span class="sc">-</span> <span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, lets fit a meta-regerssion model that has an interaction between year and environment type.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    model_lim2 <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> yi, <span class="at">V =</span> vi, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mods =</span> <span class="sc">~</span>Environment <span class="sc">*</span> year, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Article, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Datapoint), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> <span class="fu">na.omit</span>(lim))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Just like orchard_plots we just now put the model in</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    orchaRd<span class="sc">::</span><span class="fu">bubble_plot</span>(model_lim2, <span class="at">mod =</span> <span class="st">"year"</span>, <span class="at">group =</span> <span class="st">"Article"</span>, <span class="at">data =</span> <span class="fu">na.omit</span>(lim), <span class="at">by =</span> <span class="st">"Environment"</span>, <span class="at">xlab =</span> <span class="st">"Year"</span>,<span class="at">legend.pos =</span> <span class="st">"top.left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-bubble" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Noble_ESMARConf_2023_Orchard2.0_files/figure-html/fig-bubble-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Bubble plot looking at how effect size changes with year from studies conducted in the wild and captivity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Lim2014" class="csl-entry" role="doc-biblioentry">
Lim, J. N., A. M. Senior, and S. Nakagawa. 2014. <span>“Heterogeneity in Individual Quality and Reproductive Trade-Offs Within Species.”</span> <em>Evolution</em> 68 (8): 2306–18. doi: 10.1111/evo.12446.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "**orchaRd 2.0** Tutorial: ESMARConf2023"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Daniel Noble</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> [./bib/ref.bib]</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="an">biblio-style:</span><span class="co"> ./bib/methods-in-ecology-and-evolution.csl</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"> html:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: simplex</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "**Table of Contents**"</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="an">crossref:</span><span class="co"> </span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-title: Figure</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="an">width:</span><span class="co"> 10</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># How to Download and Install Orchard (vers. 2.0)</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>Orchard 2.0 is not yet on **CRAN**. You can download the package by visiting our <span class="co">[</span><span class="ot">GitHub</span><span class="co">](https://github.com/daniel1noble/orchaRd)</span> page. </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>If you don't already have the <span class="in">`pacman`</span> package **remember to unannotate code line 3**</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: packages</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-line-numbers: true</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-overflow: scroll</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"daniel1noble/orchaRd"</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("pacman")</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(devtools, tidyverse, metafor, patchwork, </span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>        R.rsp, orchaRd, emmeans, ape, phytools, gt, flextable)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scipen =</span> <span class="dv">2</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>:::{.column-margin}</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>Techncially we don't need all these packages to download <span class="in">`orchaRd`</span>, but we'll use them throughout the examples. <span class="in">`orchaRd`</span> does rely heavly on the <span class="in">`emmeans`</span> and <span class="in">`tidyverse`</span> packages. You will need to ensure that you have R updated to the required version for <span class="in">`emmeans`</span> to work as it has version requirements.</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>We also have a <span class="co">[</span><span class="ot">detailed vignette</span><span class="co">](https://daniel1noble.github.io/orchaRd/)</span> which will show much of it's functionality.</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="fu"># Orchard and Bubble Plots</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lets load a dataset</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>We'll use a very simple meta-analysis dataset that is attached to <span class="in">`orchaRd`</span> to demonstrate how you can make orchard plots and bubble plots from meta-regression models. The data come from @Lim2014. This is a meta-analysis comparing correlation coefficients (rather Fisher's *Z* Transformed Correlation), and is useful as it demonstrates a number of orchard plot functions</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lim</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-overflow: scroll</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-line-numbers: true</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the lim dataset</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(lim)</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Add in the sampling variance</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>lim<span class="sc">$</span>vi <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(lim<span class="sc">$</span>N <span class="sc">-</span> <span class="dv">3</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets fit a meta-regression </span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>lim_MR <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> yi, <span class="at">V =</span> vi, </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span>Phylum <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Article, </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>                                 <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Datapoint), </span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lim)</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lim_MR)</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>Here, we have fit a multi-level meta-regression model, with two random effects (Article / Study) and a within study variance. You will notice that we have a Phylum moderator as we are intersted in estimating the meta-analytic mean within each major phyla (@fig-orchard1). </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Orchard Plots</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>Using this model and data lets demonstrate how to make orchard plots. This can be done with the <span class="in">`orchard_plot`</span> function.</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>:::{.column-margin} </span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>If you're not sure what arguments <span class="in">`orchard_plot`</span> takes you can explore the vigette or ask for help using <span class="in">`?orchard_plot`</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>:::{.column-margin} </span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="in">`orchard_plot`</span> takes a few essential arguments:</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-args</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Key arguments</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>argument <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"model"</span>, <span class="st">"mod"</span>, <span class="st">"data"</span>, <span class="st">"group"</span>, <span class="st">"xlab"</span>)</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>descrp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"The metafor model object (e.g., rma.mv)"</span>, <span class="st">"The moderator of interest (as a character). If you don't specify it will default to the overall meta-analytic mean"</span>, <span class="st">"The dataset used to fit the model"</span>, <span class="st">"The group you wish to tally N for within brackets"</span>, <span class="st">"The axis label for the effect size"</span>)</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>tab_arg  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">Argument</span><span class="st">`</span> <span class="ot">=</span> argument,</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>                    <span class="st">`</span><span class="at">Description</span><span class="st">`</span> <span class="ot">=</span> descrp)</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(tab_arg)</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-orchard1</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Orchard plot of the @Lim2014 meta-regression model. Plotted are meta-anlaytic means, 95% confidence intervals, 95% prediction intervals and the raw effect size data weighted by the the sample size. In this case, *k* is the number of effect sizes and the number of studies are provided within brackets.</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>orchaRd<span class="sc">::</span><span class="fu">orchard_plot</span>(lim_MR, <span class="at">mod =</span> <span class="st">"Phylum"</span>, <span class="at">group =</span> <span class="st">"Article"</span>, <span class="at">data =</span> lim, <span class="at">xlab =</span> <span class="st">"Correlation coefficient"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">transfm =</span> <span class="st">"tanh"</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">N =</span> <span class="st">"N"</span>, <span class="at">cb =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="fu">## Subsetting levels in orchard plots</span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>@fig-orchard1 looks pretty bad. There's very little data in most phyla. So, lets change this by restricting the plotting to only taxa with sufficient data. We can do this using the <span class="in">`at`</span> argument to limit the prediction to only three phylo. </span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>Here we'll demonstrate a two step approach which can also provide a table of the meta-analytic means which can be used in publications</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lim_sub</span></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Orchard plot that subsets the levels</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Use mod_results to first create a table. It takes the same arguments as orchard_plot()</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>    lim_MR_results <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">mod_results</span>(lim_MR, <span class="at">mod =</span> <span class="st">"Phylum"</span>, <span class="at">group =</span> <span class="st">"Article"</span>,</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> lim, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">Phylum =</span> <span class="fu">c</span>(<span class="st">"Chordata"</span>, <span class="st">"Arthropoda"</span>, <span class="st">"Mollusca"</span>)), <span class="at">subset =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we can feed in the mod_results() table directly to orchaRd</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>    orchaRd<span class="sc">::</span><span class="fu">orchard_plot</span>(lim_MR_results, <span class="at">data =</span> lim, <span class="at">xlab =</span> <span class="st">"Correlation coefficient"</span>,</span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">transfm =</span> <span class="st">"tanh"</span>, <span class="at">g =</span> <span class="cn">TRUE</span>, <span class="at">angle =</span> <span class="dv">45</span>)</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>Ok, this is more useful, but lets also make a nice table with the <span class="in">`mod_results`</span> to report in our meta-analysis, which we can see in @tbl-lim.</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-lim</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Meta-analytic mean, 95% CIs, 95% PI's for the three phyla. To do this we need to extract the *mod_table* from the `orchaRd` object.</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(lim_MR_results<span class="sc">$</span>mod_table)</span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bubble plots</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>We often have moderators that are continuous in meta-analyis, particularly when considering things like publication bias. Here, <span class="in">`bubble_plots`</span> can be extremely useful (@fig-bubble). </span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bubble</span></span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Bubble plot looking at how effect size changes with year from studies conducted in the wild and captivity.</span></span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll add publication year in to the data and calculate the sampling variance</span></span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>    lim[, <span class="st">"year"</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lim<span class="sc">$</span>year)</span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>    lim<span class="sc">$</span>vi <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(lim<span class="sc">$</span>N <span class="sc">-</span> <span class="dv">3</span>)</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, lets fit a meta-regerssion model that has an interaction between year and environment type.</span></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>    model_lim2 <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> yi, <span class="at">V =</span> vi, </span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mods =</span> <span class="sc">~</span>Environment <span class="sc">*</span> year, </span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>                            <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Article, </span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>                                        <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Datapoint), </span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> <span class="fu">na.omit</span>(lim))</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Just like orchard_plots we just now put the model in</span></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>    orchaRd<span class="sc">::</span><span class="fu">bubble_plot</span>(model_lim2, <span class="at">mod =</span> <span class="st">"year"</span>, <span class="at">group =</span> <span class="st">"Article"</span>, <span class="at">data =</span> <span class="fu">na.omit</span>(lim), <span class="at">by =</span> <span class="st">"Environment"</span>, <span class="at">xlab =</span> <span class="st">"Year"</span>,<span class="at">legend.pos =</span> <span class="st">"top.left"</span>)</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>